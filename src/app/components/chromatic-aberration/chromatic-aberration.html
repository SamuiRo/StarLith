<svg width="0" height="0" style="position: absolute; pointer-events: none;">
  <defs>
    <filter [id]="filterId" x="-50%" y="-50%" width="200%" height="200%">
      
      <!-- Radial gradient displacement map (center to edges) --> 
       <!-- TODO -->
      <feImage 
        result="displacementMap" 
        xlink:href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cdefs%3E%3CradialGradient id='dg'%3E%3Cstop offset='0%25' stop-color='%23000000'/%3E%3Cstop offset='50%25' stop-color='%23000000'/%3E%3Cstop offset='85%25' stop-color='%23808080'/%3E%3Cstop offset='100%25' stop-color='%23ffffff'/%3E%3C/radialGradient%3E%3C/defs%3E%3Crect width='100' height='100' fill='url(%23dg)'/%3E%3C/svg%3E"
        x="0%" y="0%" 
        width="100%" height="100%"
        preserveAspectRatio="none"/>
      
      <!-- Split into RGB channels -->
      <feColorMatrix in="SourceGraphic" type="matrix"
        values="1 0 0 0 0
                0 0 0 0 0
                0 0 0 0 0
                0 0 0 1 0" result="red"/>
      
      <feColorMatrix in="SourceGraphic" type="matrix"
        values="0 0 0 0 0
                0 1 0 0 0
                0 0 0 0 0
                0 0 0 1 0" result="green"/>
      
      <feColorMatrix in="SourceGraphic" type="matrix"
        values="0 0 0 0 0
                0 0 0 0 0
                0 0 1 0 0
                0 0 0 1 0" result="blue"/>
      
      <!-- Apply displacement based on gradient -->
      <feDisplacementMap in="red" in2="displacementMap" 
        [attr.scale]="redScale" 
        xChannelSelector="R" yChannelSelector="R" result="redDisplaced"/>
      
      <feDisplacementMap in="blue" in2="displacementMap" 
        [attr.scale]="blueScale" 
        xChannelSelector="R" yChannelSelector="R" result="blueDisplaced"/>
      
      <!-- Apply channel offsets (red left, blue right) -->
      <feOffset in="redDisplaced" [attr.dx]="redOffset.x" [attr.dy]="redOffset.y" result="redShift"/>
      <feOffset in="blueDisplaced" [attr.dx]="blueOffset.x" [attr.dy]="blueOffset.y" result="blueShift"/>
      
      <!-- Combine channels using screen blend mode -->
      <feBlend in="redShift" in2="green" mode="screen" result="rg"/>
      <feBlend in="rg" in2="blueShift" mode="screen" result="final"/>
      
      <!-- Mix with original to preserve center clarity -->
      <feComposite in="SourceGraphic" in2="final" operator="arithmetic"
        k1="0" k2="0.6" k3="0.4" k4="0"/>
      
    </filter>
  </defs>
</svg>

<div class="chromatic-wrapper" [style.filter]="'url(#' + filterId + ')'">
  <ng-content></ng-content>
</div>